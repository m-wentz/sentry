<div align="center">
  <pre>
███████╗███████╗███╗   ██╗████████╗██████╗ ██╗   ██╗
██╔════╝██╔════╝████╗  ██║╚══██╔══╝██╔══██╗╚██╗ ██╔╝
███████╗█████╗  ██╔██╗ ██║   ██║   ██████╔╝ ╚████╔╝ 
╚════██║██╔══╝  ██║╚██╗██║   ██║   ██╔══██╗  ╚██╔╝  
███████║███████╗██║ ╚████║   ██║   ██║  ██║   ██║   
╚══════╝╚══════╝╚═╝  ╚═══╝   ╚═╝   ╚═╝  ╚═╝   ╚═╝   
  ---
  automate employee alerting and interactions
  </pre>
  <!-- License badge -->
  <a href="https://opensource.org/licenses/MIT">
  <img src="https://img.shields.io/badge/License-MIT-yellow.svg" alt="License: MIT">
  </a>
</div>
<br>
<!-- Description -->
<p>A Python-based Slack app that automates the delivery of security alerts generated in Splunk to the relevant team members within a Slack workspace. It also integrates with SolarWinds ServiceDesk to update incidents automatically. Tailored for security teams, this bot with it's current alerting capabilities aims to improve response times and reduce manual workload by automating notifications and interactions for unauthorized document downloads.</p>
<!-- Prerequisites -->
<h2>Prerequisites</h2>
<ul>
  <li>Python 3.x</li>
  <li>pip (Python package manager)</li>
</ul>
<!-- Installation -->
<h2>Installation</h2>
<ol>
  <li>
    <strong>Clone This Repository:</strong>
    <pre><code>git clone https://github.com/m-wentz/sentry</code></pre>
  </li>
  <li>
    <strong>Navigate to the App Directory:</strong>
    <pre><code>cd sentry</code></pre>
  </li>
  <li>
    <strong>Install Required Packages:</strong>
    <pre><code>pip install -r requirements.txt</code></pre>
  </li>
</ol>
<!-- Configuration Section -->
<h2>Configuration</h2>
<p><strong>Disclaimer:</strong> This application uses specific key-value pairs based on our unique alerting setup in Splunk. When configuring this app for your use, you will need to adjust these key-value pairs to align with the alerts generated by your Splunk instance. Consider this project as a flexible template, designed to inspire and facilitate modifications to meet your specific security alerting needs.</p>
<p>To configure the application, you'll need to set up various environment variables that the app uses to operate. These variables include details about your organization, the Flask server settings, and credentials for Slack and ServiceDesk integrations. Follow these steps to configure your environment:</p>
<ol>
  <li>
    <strong>Rename the <code>.env.example</code> File:</strong>
    <ul>
      <li>Rename the provided <code>.env.example</code> file to <code>.env</code>.</li>
      <li>This file will store your configuration settings.</li>
    </ul>
  </li>
  <li>
    <strong>Organization's Name:</strong>
    <ul>
      <li><code>ORG_NAME</code>: Enter the name of your organization. Used in application context.</li>
      <li>Example: <code>ORG_NAME=MyCompany</code></li>
    </ul>
  </li>
  <li>
    <strong>Flask Server Configuration:</strong>
    <ul>
      <li><code>FLASK_HOST</code>: Set the host IP address for the Flask server. Use <code>127.0.0.1</code> for localhost, or <code>0.0.0.0</code> to make the server publicly available.</li>
      <li><code>FLASK_PORT</code>: Enter the port number for the Flask server. The default Flask port is 5000.</li>
      <li>
        Example: 
        <pre><code>FLASK_HOST=127.0.0.1\nFLASK_PORT=5000</code></pre>
      </li>
    </ul>
  </li>
  <li>
    <strong>SSL Certificate and Key:</strong>
    <ul>
      <li><code>SSL_CERT_PATH</code>: Provide the path to your SSL certificate file for HTTPS connections.</li>
      <li><code>SSL_KEY_PATH</code>: Provide the path to your SSL private key file.</li>
      <li>Ensure you have a valid SSL certificate for secure connections.</li>
      <li>
        Example: 
        <pre><code>SSL_CERT_PATH=path/to/certificate.crt\nSSL_KEY_PATH=path/to/private.key</code></pre>
      </li>
    </ul>
  </li>
  <li>
    <strong>Slack Integration:</strong>
    <ul>
      <li><code>SLACK_TOKEN</code>: Enter your Slack API token for integrating with Slack services.</li>
      <li>Format: <code>xoxb-XXXXXXXXXXXX-TTTTTTTTTTTTTT</code></li>
      <li>
        <strong>OAuth Scopes</strong>: Your Slack app will need the following OAuth scopes enabled:
        <ul>
          <li><code>channels:history</code>: To view messages and other content in public channels that the app has been added to.</li>
          <li><code>chat:write</code>: To send messages as the app.</li>
          <li><code>im:history</code>: To view messages and other content in direct messages that the app has been added to.</li>
          <li><code>users:read</code>: To view people in a workspace.</li>
          <li><code>users:read.email</code>: To view email addresses of people in a workspace.</li>
        </ul>
      </li>
      <li><strong>Interactivity</strong>: Interactivity must be enabled for your Slack app to receive and respond to interactive events. You will need to provide a valid public Request URL that your Flask application can handle.</li>
    </ul>
  </li>
  <li>
    <strong>ServiceDesk Integration:</strong>
    <ul>
      <li><code>SD_TOKEN</code>: Enter the token for authenticating with the ServiceDesk API.</li>
      <li>Format: <code>&quot;Bearer &lt;your_service_desk_token&gt;&quot;</code></li>
      <li><code>SD_URL</code>: Set the base URL for the ServiceDesk API endpoints.</li>
      <li><code>SD_UID</code>: Enter User ID for the ServiceDesk user updating the incident.</li>
      <li>
        Example: 
        <pre><code>SD_TOKEN=Bearer your_service_desk_token\nSD_URL=https://api.samanage.com/incidents\nSD_UID=12345678</code></pre>
      </li>
    </ul>
  </li>
  <li>
    <strong>Slack Channel for Feed:</strong>
    <ul>
      <li><code>FEED_CH</code>: Enter the Channel ID for the feed in Slack.</li>
      <li>Example: <code>FEED_CH=I7JQLKNXYBR</code></li>
    </ul>
  </li>
</ol>
<h2>Usage</h2>
<p>After you have installed and configured the application, you can begin using it by following these steps:</p>
<h3>1. Starting the Flask Web Server:</h3>
<pre><code>python run.py</code></pre>
<p>Ensure you are in the root directory of the project when you execute this command. The server should start, and you'll see output indicating that it's running on the configured host and port.</p>
<h3>2. Testing the Web Server:</h3>
<p>Testing the web server is important to ensure it's correctly receiving and processing the alerts from Splunk. You can simulate a Splunk post request using <code>curl</code> or Postman.</p>
<ul>
  <li>
    <strong>Using curl:</strong> Execute a command similar to the following, replacing the URL and JSON data with the appropriate values for your setup:
    <pre><code>curl -X POST http://127.0.0.1:5000/alert -H 'Content-Type: application/json' -d '{"key1": "value1", "key2": "value2"}'</code></pre>
  </li>
  <li><strong>Using Postman:</strong> Set up a new POST request with the web server's URL and the necessary headers and body to mimic the Splunk alert.</li>
</ul>
<p>After successfully sending the simulated request, verify that the Flask server processes it correctly and performs the expected actions, such as posting a message to Slack or updating an incident in SolarWinds ServiceDesk.</p>

<!-- Contributing Section -->
<h2>Contributing</h2>
<p>As a personal project, I am currently the sole contributor. While I appreciate interest in the project, I am not seeking external contributions at this time. However, feel free to fork the repository and experiment with your own ideas!</p>

<p>If you have any suggestions or feedback, you're welcome to open an issue on GitHub. I'm always interested in hearing how others are using the project or ways it might be improved for personal use cases.</p>

<p>Thank you for your interest and support!</p>

<h2>Let's Connect!</h2>
<p>
  <a href="https://www.linkedin.com/in/m-wentz"><img src="https://github.com/gauravghongde/social-icons/blob/master/SVG/White/LinkedIN_white.svg" alt="LinkedIn"></a>
  <a href="https://github.com/m-wentz"><img src="https://github.com/gauravghongde/social-icons/blob/master/SVG/White/Github_white.svg" alt="GitHub"></a>
</p>